#
# Log events from Maven encoders
#
if [type] == 'maven' {
  ruby { code => "event['received_at'] = event['@timestamp']" } # save the @timestamp as received_at
  grok {
    'patterns_dir' => 'patterns'
    'add_tag'      => 'maven_match_agent'
    'match'        => [ 'agent', '%{MAVEN_AGENT}' ]
  }
  mutate {
    'add_field' => [ 'mac', '%{[maven][mac]}' ]
    'add_tag'   => 'maven_mutate_mac'
  }
  date {
    'add_tag' => 'maven_timestamp'
    'match'   => [ '[maven][timestamp]', 'ISO8601' ]
  }
  # geoip {
  #   'add_tag' => 'geoip'
  #   'source'  => 'clientip'
  # }
}
